<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Terrassa’s Buildings by gdsa-upc</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Terrassa’s Buildings</h1>
      <h2 class="project-tagline">Projecta GDSA</h2>
      <a href="https://github.com/gdsa-upc/Terrassa-s-Buildings" class="btn">View on GitHub</a>
      <a href="https://github.com/gdsa-upc/Terrassa-s-Buildings/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/gdsa-upc/Terrassa-s-Buildings/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>Aquesta web neix a partir de l'assignatura Gestió i Distribució de Senyals Audiovisuals, on es planteja el desenvolupament d'un projecta que es basa en la cerca visual. Aquest projecta l'hem donat com a nom Terrassa's Buildings i els seus desenvolupadors són:</p>

<table>
<thead>
<tr>
<th>Nom i Cognom</th>
<th>Perfil Github</th>
<th>Perfil de LinkedIn</th>
</tr>
</thead>
<tbody>
<tr>
<td>Marta Barrachina</td>
<td><a href="https://github.com/Mmarta19">Enllaç</a></td>
<td><a href="https://es.linkedin.com/in/marta-barrachina-234697117">Enllaç</a></td>
</tr>
<tr>
<td>Marta Coll</td>
<td><a href="https://github.com/MartaCollPol">Enllaç</a></td>
<td></td>
</tr>
<tr>
<td>David Molina</td>
<td><a href="https://github.com/Damocle21">Enllaç</a></td>
<td></td>
</tr>
</tbody>
</table>

<p>En concret Terrassa's Buildings és una plataforma que està implementada i desenvolupada amb el llenguatge Python. L'estructura del projecta es basa en:</p>

<p><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/gh-pages/images/Captura%20de%20pantalla%202016-11-27%20a%20les%209.50.26.png?raw=true" alt="Estructura"></p>

<p>Per entendre millor el projecta, s'ha dividit aquest en sessions. En cada una de les sessions s'explica en detall els passos que s'han portat a terme per obtenir l'objectiu final.</p>

<table>
<thead>
<tr>
<th>Sessions</th>
<th>informe</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sessió 3</td>
<td><a href="https://docs.google.com/presentation/d/10qN_5L64CRrDN-KxAChikhTSHKhgo5Zdgb-cuL4wFAA/edit?usp=sharing">Extracció de característiques</a></td>
</tr>
<tr>
<td>Sessió 4</td>
<td><a href="https://docs.google.com/presentation/d/1BYy3HgLG6q_1lNq15vN7Gp8xHzMo9Y2DdIURvjgpsQ4/edit?usp=sharing">Sistema aleatori</a></td>
</tr>
</tbody>
</table>

<h1>
<a id="sessió-3" class="anchor" href="#sessi%C3%B3-3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://docs.google.com/presentation/d/10qN_5L64CRrDN-KxAChikhTSHKhgo5Zdgb-cuL4wFAA/edit?usp=sharing">Sessió 3</a>
</h1>

<p>En aquesta primera part del projecta s'ha realitzat una <a href="https://drive.google.com/file/d/0BwPBlegi0csQamhIU3YyT1o3ZGs/view?usp=sharing">Base de Dades</a> amb 150 imatges diferents. Majoritàriament trobem imatges del Museu de la Ciència i la Tecnologia de Terrassa, del Mercat de la Independència. Encara així, en la base de dades també hi han imatges d'edificis desconeguts. Totes aquestes fotografies serviran d'entrenament al sistema. </p>

<table>
<thead>
<tr>
<th><a href="http://mnactec.cat/ca/">MNACTEC</a></th>
<th><a href="http://www.mercatdelaindependencia.cat/?doing_wp_cron=1479940928.3758389949798583984375">Mercat de la Independència</a></th>
<th>Desconegut</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/gh-pages/images/1354-30624-16524.jpg?raw=true" alt=""></td>
<td><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/gh-pages/images/3311-27747-29929.jpg?raw=true" alt=""></td>
<td><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/gh-pages/images/Desconegut_102.jpg?raw=true" alt=""></td>
</tr>
</tbody>
</table>

<p>El sistema també farà servir 450 fotografies de diferents edificis de Terrassa, on la seva utilitat és de validació que serviran per evaluar el sistema. Aquestes imatges es poden trobar a la pàgina web del UPC <a href="https://imatge.upc.edu/web/resources/terrassa-buildings-900">Terrassa Building 900</a>.</p>

<p>Un cop hem obtingut totes les imatges, és important fer una anotació d'aquestes per generar correctament la base de dades. El sistema d'anotació que s'ha utilitzat en aquest projecta és el següent:</p>

<p><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/gh-pages/images/Captura%20de%20pantalla%202016-11-27%20a%20les%2011.31.12.png?raw=true" alt=""></p>

<p>Totes aquestes imatges s'han guardat en un arxiu <a href="https://drive.google.com/file/d/0BwPBlegi0csQamhIU3YyT1o3ZGs/view?usp=sharing">ZIP</a>.</p>

<p>Pel desenvolupament del projecta s'ha fet servir dos entorns de desenvolupament local.</p>

<ul>
<li><p><a href="https://www.enthought.com/products/canopy/">Canopy</a>: Entorn d'anàlisi de Python integral que proporciona més de 450 paquets de Python.</p></li>
<li><p><a href="https://atom.io">Atom</a>: Editor de text de software lliure en el que es pot treballar còmodament amb diferents idiomes de programació. Disposa de molts paquets descarregables que amplien les seves funcions com ara compiladors o personalitzadors. </p></li>
</ul>

<p>Amb aquestes dos entorns s'ha genera el primer script. Aquest es basa en l'extracció de punts d'interès d'una imatges. S'ha fet de dos extractors de característiques diferents, SURF i SIFT. A continuació podeu veure els codis realitzats agafant d'exemple una imatge d'un tigre:</p>

<ol>
<li>SURFT</li>
</ol>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> numpy <span class="pl-k">as</span> np
<span class="pl-k">import</span> cv2
<span class="pl-k">import</span> matplotlib.pyplot <span class="pl-k">as</span> plt


img <span class="pl-k">=</span> cv2.imread(<span class="pl-s"><span class="pl-pds">'</span>//Users/Marta/Desktop/fotos escriptori/TIGRE.JPG<span class="pl-pds">'</span></span>,<span class="pl-c1">0</span>)
surf <span class="pl-k">=</span> cv2.SURF(<span class="pl-c1">4000</span>)
kp, des <span class="pl-k">=</span> surf.detectAndCompute(img, <span class="pl-c1">None</span>)
img2 <span class="pl-k">=</span> cv2.drawKeypoints(img, kp, <span class="pl-c1">None</span>, (<span class="pl-c1">255</span>,<span class="pl-c1">0</span>,<span class="pl-c1">0</span>), <span class="pl-c1">4</span>)
plt.imshow(img2),plt.show()
<span class="pl-c1">print</span> <span class="pl-c1">len</span>(kp)</pre></div>

<p><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/master/1--Keypoints/figure_1.png?raw=true" alt=""></p>

<p>Utilitzant SURFT podem observar que ens detalla els contorns més pronunciats de la imatge.</p>

<ol>
<li>SIFT</li>
</ol>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> numpy <span class="pl-k">as</span> np
<span class="pl-k">import</span> cv2
<span class="pl-k">import</span> matplotlib.pyplot <span class="pl-k">as</span> plt


img <span class="pl-k">=</span> cv2.imread(<span class="pl-s"><span class="pl-pds">'</span>//Users/Marta/Desktop/fotos escriptori/TIGRE.JPG<span class="pl-pds">'</span></span>,<span class="pl-c1">0</span>)
sift <span class="pl-k">=</span> cv2.SIFT(<span class="pl-c1">4000</span>)
kp, des <span class="pl-k">=</span> sift.detectAndCompute(img, <span class="pl-c1">None</span>)
img2 <span class="pl-k">=</span> cv2.drawKeypoints(img, kp, <span class="pl-c1">None</span>, (<span class="pl-c1">255</span>,<span class="pl-c1">0</span>,<span class="pl-c1">0</span>), <span class="pl-c1">4</span>)
plt.imshow(img2),plt.show()
<span class="pl-c1">print</span> <span class="pl-c1">len</span>(kp)</pre></div>

<p><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/master/1--Keypoints/Imagen%201.png?raw=true" alt=""></p>

<p>En aquest cas com veiem a la imatge anterior, el resultat de l'extracció de característiques és més detallat. Sobretot en els canvis d'intensitat, és a dir, en els contorns.</p>

<p>Les proves d'aquest primer script també s'han realitzat a <a href="http://jupyter.org">Jupyter</a>. Podeu veure tot el codi realitzat a <a href="https://github.com/gdsa-upc/Terrassa-s-Buildings/tree/master/1--Keypoints">GitHub</a>.</p>

<h1>
<a id="sessió-4" class="anchor" href="#sessi%C3%B3-4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://docs.google.com/presentation/d/1BYy3HgLG6q_1lNq15vN7Gp8xHzMo9Y2DdIURvjgpsQ4/edit?usp=sharing">Sessió 4</a>
</h1>

<p>L'estructura per blocs d'aquesta sessió seria:</p>

<p><img src="https://github.com/gdsa-upc/Terrassa-s-Buildings/blob/gh-pages/images/Captura%20de%20pantalla%202016-11-27%20a%20les%2012.26.07.png?raw=true" alt=""></p>

<p>En concret, en aquesta part del projecta la intenció es extreure les característiques de les imatges que formen part de la nostra <a href="https://drive.google.com/file/d/0BwPBlegi0csQamhIU3YyT1o3ZGs/view?usp=sharing">Base de Dades</a>. L'extractor ens retorna un vector de característiques per cada punt d'interès. </p>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># -*- coding: utf-8 -*-</span>
<span class="pl-k">import</span> os 

<span class="pl-k">def</span> <span class="pl-en">build_database</span> (<span class="pl-smi">indir</span>,<span class="pl-smi">outdir</span>): <span class="pl-c">#definim la funció</span>
    images <span class="pl-k">=</span> os.listdir(indir)  <span class="pl-c">#llegeixo tots els noms dels fitxers del directori d'entrada i els guarda a imatges</span>
    outfile <span class="pl-k">=</span> <span class="pl-c1">open</span>(outdir<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span>/ID.txt<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>w<span class="pl-pds">'</span></span>)   <span class="pl-c">#crea el fitxer on escriu els id.</span>
    <span class="pl-k">for</span> <span class="pl-v">file</span> <span class="pl-k">in</span> images: <span class="pl-c">#recorre tots els id i els escriu al fitxer</span>
        outfile.write(<span class="pl-v">file</span>[<span class="pl-c1">0</span>:<span class="pl-k">-</span><span class="pl-c1">4</span>]<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>) 
        <span class="pl-c1">print</span>(<span class="pl-v">file</span>)
    outfile.close()<span class="pl-c">#tanca el fitxer</span>


ruta1<span class="pl-k">=</span>os.path.dirname(os.path.abspath(<span class="pl-c1">__file__</span>))<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span>/TerrassaBuildings900/val/images<span class="pl-pds">'</span></span>
ruta2<span class="pl-k">=</span>os.path.dirname(os.path.abspath(<span class="pl-c1">__file__</span>))<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span>/TerrassaBuildings900/train/images<span class="pl-pds">'</span></span>
savepath1<span class="pl-k">=</span>os.path.dirname(os.path.abspath(<span class="pl-c1">__file__</span>))<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span>/TerrassaBuildings900/val<span class="pl-pds">'</span></span>
savepath2<span class="pl-k">=</span>os.path.dirname(os.path.abspath(<span class="pl-c1">__file__</span>))<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span>/TerrassaBuildings900/train<span class="pl-pds">'</span></span>

build_database(ruta1,savepath1)
build_database(ruta2,savepath2)</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/gdsa-upc/Terrassa-s-Buildings">Terrassa’s Buildings</a> is maintained by <a href="https://github.com/gdsa-upc">gdsa-upc</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
